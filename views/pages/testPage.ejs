<!DOCTYPE html>
<html>
<head>
  <%- include ("../partials/header.ejs") %>
</head>

<body>

<%- include ("../partials/nav.ejs") %>

<div class="container">

    <div class="row d-flex  my-4">
        <div class="test__block col-lg-6">
            <div class="student__info flex-column">
                <h4 class="text-center">
                    Информация о проведенном тесте
                </h4>
                <div class="groupInfo d-flex align-items-center">
                    <h5>
                        Тестируемая группа: 
                    </h5>
                    <a href=<%= `${globalLink}/groups/${groupId}` %> class="mx-2 btn btn-warning w-25">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-box-arrow-in-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M6.364 13.5a.5.5 0 0 0 .5.5H13.5a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 13.5 1h-10A1.5 1.5 0 0 0 2 2.5v6.636a.5.5 0 1 0 1 0V2.5a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v10a.5.5 0 0 1-.5.5H6.864a.5.5 0 0 0-.5.5z"/>
                            <path fill-rule="evenodd" d="M11 5.5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793l-8.147 8.146a.5.5 0 0 0 .708.708L10 6.707V10.5a.5.5 0 0 0 1 0v-5z"/>
                          </svg>
                          <%= thisTestInfo.groupName %>
                    </a>
                </div>
                <h5>
                    Дата проведения:
                    <%= new Date(thisTestInfo.date).toLocaleDateString('ru-RU') %> 
                </h5>
                <h5>
                    Предмет:
                    <%= thisTestInfo.subject %>
                </h5>
                <h5>
                    Формат тестирования:
                    <%= thisTestInfo.format %>
                </h5>
            </div>
        </div>
    </div>

    <div class="row d-flex student__block my-4">
        <div class="col">
            <table class="table table-striped table-hover table-bordered border-primary">
                <tr>
                   <th>Имя ученика</th>
                   <th>Набранные баллы</th>
                   <th>Максимальный балл</th>
                   <th>% от максимума</th>
                </tr>
                <%     allGradesInfo.forEach(function(grade) { %>
      
                <tr>
                   <td class="names"><%= grade.studentName %></td>
                   <td><%= grade.studentGrade %></td>
                   <td><%= thisTestInfo.questionsQuantity %></td>
                   <td class="percents"><%= grade.percentOfMaximum %></td>
                   
                </tr>
                <% }); %>
             </table>

        </div>

    </div>


    <div class="row d-flex group__block my-4">
        <div class="col py-2">
          <div id="chart">
          </div>
        </div>
    </div> 
    
</div>

<script>

const names = Array.from(document.querySelectorAll('.names')).map((el) => el.innerHTML);
    const percents = Array.from(document.querySelectorAll('.percents')).map((el) => el.innerHTML);
    
    
    var options = {
          series: [{
          name: '% от максимума',
          data: percents
        }],
        chart: {
          height: 350,
          type: 'bar',
        },
        plotOptions: {
          bar: {
            borderRadius: 10,
            columnWidth: '50%',
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          width: 2
        },
        
        grid: {
          row: {
            colors: ['#fff', '#f2f2f2']
          }
        },
        xaxis: {
          labels: {
            rotate: -45
          },
          categories: names,
        },
        yaxis: {
          title: {
            text: '% от максимума',
          },
          max: 100,
        },
        fill: {
          type: 'gradient',
          gradient: {
            shade: 'light',
            type: "horizontal",
            shadeIntensity: 0.25,
            gradientToColors: undefined,
            inverseColors: true,
            opacityFrom: 0.85,
            opacityTo: 0.85,
            stops: [50, 0, 100]
          },
        }
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
    




</script>

<%- include ("../partials/footer.ejs") %>